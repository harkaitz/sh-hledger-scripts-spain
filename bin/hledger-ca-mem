#!/bin/sh -e
##:
#h: Usage: hledger-ca-mem ...
#h:
#h: ... 1  : Actividad de la empresa.
#h: ... 2  : Bases de presentación de las cuentas.
#h: ... 3  : Normas de registro y valoración.
#h: ... 4  : Inm. material, intangible e inversiones inmob.
#h: ... 5  : Activos financieros.
#h: ... 6  : Pasivos financieros.
#h: ... 7  : Fondos propios.
#h: ... 8  : Situación fiscal.
#h: ... 9  : Operaciones con partes vinculadas.
#h: ... 10 : Otra información.
##:
. hledger-get
. hledger-info
. hledger-es
hledger_ca_mem() {
    local cmd="$1"
    shift
    case "${cmd}" in
        1|2|3|4|5|6|7|8|9|10) hledger_ca_mem_"${cmd}";;
        *) echo >&2 "error: Argumento invalido: ${cmd}"; return 1;;
    esac
}
## -------------------------------------------------------------------
hledger_ca_mem_1() {
    less <<-EOF
	$(getinfo -g COMPANY_SOCIAL_DENOMINATION=s) (en adelante, la Sociedad) se constituyó el $(getinfo -g COMPANY_FORMATION_DATE_ES=s). Es una
	sociedad constituida en $(getinfo -g COMPANY_FORMATION_STATE_ES=s) de conformidad con la Ley de Sociedades de Capital. El objeto de la
	empresa, de acuerdo con sus estatutos es el siguiente:
	
	$(getinfo -G COMPANY_STATUTES_ES=s)
	
	Su domicilio social se encuentra en $(getinfo -g COMPANY_SOCIAL_ADDRESS=s).
	EOF
    return 0
}
## -------------------------------------------------------------------
hledger_ca_mem_2() {
    less <<-EOF
	# Bases de presentación de las Cuentas Anuales
	
	## Marco normativo de información financiera aplicable a la Sociedad
	
	Estas Cuentas Anuales se han formulado por los Administradores de acuero con el marco normativo de
	información financiera aplicable a la Sociedad, que es el establecido en:
	
	a) Código de Comercio y la restante legislación mercantil.
	b) Plan General de Contabilidad aprobado por el Real Decreto 1514/2007, de 16 de noviembre, el
	   cual ha sido modificado en 2016 por el Real Decreto 602/2016, de 2 de diciembre, así como con el
	   resto de la legislación mercantil vigente.
	c) Las normas de obligado cumplimiento aprobadas por el Instituto de Contabilidad y Auditoria de
	   Cuentas en desarrollo del Plan General de Contabilidad y sus normas complementarias.
	d) El resto de la normativa contable española que resulte de aplicación.
	
	## Imagen fiel
	
	Las Cuentas Anuales adjuntas han sido obtenidas de los registros contables de la Sociedad y se presentan
	de acuerdo con el marco normativo de información financiera que le resulta de aplicación y en particular, los
	principios y criterios contables en él contenidos, de forma que muestran la imagen fiel del patrimonio, de la
	situación financiera y de los resultados de la Sociedad habidos durante el correspondiente ejercicio. Estas
	Cuentas Anuales han sido formuladas por los Administradores de la Sociedad.
	
	## Principios contables no obligatorios aplicados
	
	No se han aplicado principios contables no obligatorios. Adicionalmente, los Administradores han formulado
	estas Cuentas Anuales teniendo en consideración la totalidad de los principios y normas contables de
	aplicacion obligatoria que tienen un efecto significativo en dichas Cuentas Anuales. No existe ningún
	principio contable que siendo obligatorio, haya dejado de aplicarse.
	
	## Aspectos criticos de la valoración y estimación de la incertidumbre
	
	La preparación de las cuentas anuales exige el uso por parte de la Sociedad de ciertas estimaciones y
	juicios, en relación con el futuro, que se evalúan continuamente y se basan en el experiencia histórica y
	otros factores, incluidas las expectativas de sucesos futuros que se creen razonables bajo las
	circunstancias que se apliquen.
	
	$(hledger_ca_mem_2_comparacion\
	)## Elementos recogidos en varias partidas
	
	La Sociedad no mantiene ningun elemento patrimonial recogido en varias partidas.
	
	EOF
    return 0
}
hledger_ca_mem_2_comparacion() {
    case "$(getinfo -g COMPANY_CA_FIRST=yn)" in
        y)
            cat <<-EOF
		## Comparación de la información
		
		La Sociedad se constituy6 el 25 de julio de 2018, por lo que al ser las presentes Cuentas Anuales las
		inicilales, no procede presentar cifras comparativas.
		
		EOF
            ;;
        n)
            echo >&2 "error: COMPANY_CA_FIRST: 'n' not implemented"
            return 1
            ;;
    esac
}
## -------------------------------------------------------------------
hledger_ca_mem_3() {
    less <<-EOF
	# Normas de registro y valoración
	
	Las principales normas de registro y valoración utilizadas por la Sociedad en la elaboración de sus Cuentas
	Anuales del ejercicio 2018, de acuerdo con las establecidas por el Plan General de Contabilidad, han sido
	las siguientes
	
	## Instrumentos financieros
	
	### I. Activos financieros
	
	Los activos financieros que posee la Sociedad se clasifican en la siguiente categoria:
	
	a) Préstamos y partidas a cobrar: activos financieros originados en la venta de bienes o en la
	   prestación de servicios por operaciones de trafico de la empresa, o los que no teniendo un origen
	   comercial, no son instrumenios de patrimonio ni derivados y cuyos cobros son de cuantía fija o
	   determinable y no se negocian en un mercado activo.
	
	   Se valoran inicialmente por su valor razonable, que, salvo evidencia en contrario, es el precio de la
	   transaccion, que equivale al valor razonable de la contraprestacién entregada, mas los costes de
	   transaccin que sean directamente atribuibles.
	
	   Posteriormente se valoran por su coste amortizado.
	
	b) Tesoreria y otros activos liquidos equivalentes: la tesoreria comprende tanto la caja como los
	   depósitos bancarios a la vista. Los otros activas liquidos equivalentes son inversiones a corto
	   plazo, con vencimientos anteriores a tres meses, y que no estan sujetos a un riesgo relevante de
	   cambios en su valor.
	
	### II. Pasivos financieros
	
	Son pasivos financieros aquellos debitos y partidas a pagar que tiene la Sociedad y que se han originado en
	la compra de bienes y servicios por operaciones de trafico de la empresa, o también aquellos que sin tener
	un origen comercial, no pueden ser considerados como instrumentos financieros derivados.
	
	Los débitos y partidas a pagar se valoran inicialmente al valor razonable de la contraprestacion recibida,
	ajustada por los costes de la transaccién directamente atribuibles. Con posterioridad, dichos pasivos se
	valoran de acuerdo con su coste amortizado.
	
	$(hledger_ca_mem_3_existencias\
	)## Impuestos sobre beneficios
	
	El gasto o ingreso por impuesto sobre beneficios comprende la parte relativa al gasto o ingreso por el
	impuesto corriente y la parte correspondiente al gasto o ingreso por impuesto diferido.
	
	El impuesto corriente es la cantidad que la Sociedad satisface como consecuencia de las liquidaciones
	fiscales del impuesto sobre el beneficio relativas a un ejercicio. Las deducciones y otras ventajas fiscales en
	la cuota del impuesto, excluidas las retenciones y pagos a cuenta, asi como las pérdidas fiscales
	compensables de ejercicios anteriores y aplicadas efectivamente en éste, dan lugar a un menor importe del
	impuesto corriente.
	
	El gasto o el ingreso por impuesto diferido se corresponde con el reconocimiento y la cancelación de los
	activos y pasivos por impuesto diferido. Estos incluyen las diferencias temporarias que se identifican como
	aquellos importes que se prevén pagaderos o recuperables derivados de las diferencias entre los importes
	en libros de [os activos y pasivos y su valor fiscal, asi como las bases imponibles negativas pendientes de
	compensacion y los créditos por deducciones fiscales no aplicadas fiscalmente. Dichos importes se
	registran aplicando a la diferencia temporaria o crédito que corresponda el tipo de gravamen al que se
	espera recuperarlos o liquidarlos.
	
	Se reconocen pasivos por impuestos diferidos para todas las diferencias temporarias imponibles, excepto
	aquellas derivadas del reconocimiento inicial de fondos de comercio o de otros activos y pasivos en una
	operación que no afecta ni al resultado fiscal ni al resultado contable y no es una combinacion de negocios.
	
	Por su parte, los activos por impuestos diferidos solo se reconocen en la medida en que se considere
	probable que la Sociedad vaya a disponer de ganancias fiscales futuras contra las que poder hacerlos
	efectivos.
	
	Los activos y pasivos por impuestos diferidos, originados por operaciones con cargos o abonos directos en
	cuentas de patrimonio, se contabilizan también con contrapartida en patrimonio neto.
	
	En cada cierre contable se reconsideran los activos por impuestos diferidos registrados, efectuandose las
	oportunas correcciones a los mismos en la medida en que existan dudas sobre su recuperacidon futura.
	Asimismo, en cada cierre se evaluan los activos por impuestos diferidos no registrados en balance y éstes
	son objeto de reconocimiento en la medida en que pase a ser probable su recuperacién con beneficios
	fiscales futuros.
	
	## Ingresos y gastos
	
	Los ingresos y gastos se imputan en función del criterio de devengo, es decir, cuande se produce la
	corriente real de bienes y servicios que los mismos representan, con independencia del momento en que se
	produzca la corriente monetaria o financiera derivada de ellos. Dichos ingresos se valoran por el valor
	razonable de la contraprestacion recibida, deducidos descuentos e impuestos.
	
	El reconocimiento de los ingresos por ventas se produce en el momento en que se han transferido al
	comprador los riesgos y beneficios significativos inherentes a la propiedad del bien vendido, no
	manteniendo ia gestion corriente sobre dicho bien, ni reteniendo ej control efective sobre el mismo.
	
	En cuanto a los ingresos por prestación de servicios, éstos se reconocen considerando el grado de
	realización de la prestacion a la fecha de balance, siempre y cuando el resultado de la transaccién pueda
	ser estimado con fiabilidad.
	
	## Provisiones y contingencias
	
	Los Administradores de ta Sociedad en la formulación de las Cuentas Anuales diferencian entre:
	
	a) Provisiones: saldos acreedores que cubren obligaciones actuales derivadas de sucesos pasados,
	   cuya cancelacion es probable que origine una salida de recursos, pero que resultan
	   indeterminades en cuanto a su importe y/o momento de cancelación.
	
	b) Pasivos contingentes: obligaciones posibles surgidas como consecuencia de sucesos pasados,
	   cuya materializacion futura esta condicionada a que ocurra, o no, uno o mas eventos futuros
	   independientes de la voluntad de la Sociedad.
	
	Las Cuentas Anuales recogen todas las provisiones con respecto a las cuales se estima que la probabilidad
	de que se tenga que atender la obligacién es mayor que de lo contrario. Los pasivos contingentes no se
	reconocen en las Cuentas Anuaies, sino que se informa sobre los mismos en las notas de la memoria, en la
	medida en que no sean considerados como remotos.
	
	Las provisiones se valoran por el valor actual de la mejor estimación posible del importe necesario para
	cancelar o transferir la obligación, teniendo en cuenta la informacién disponible sobre el suceso y sus
	consecuencias, y registrandose los ajustes que surjan por la actualizacién de dichas provisiones como un
	gasto financiero conforme se va devengando.
	
	La compensación a recibir de un tercero en el momento de liquidar la obligación, siempre que no existan
	dudas de que dicho reembolso sera percibido, se registra como activo, excepto en el caso de que exista un
	vinculo legal por el que se haya exteriorizado parte del riesgo, y en virtud del cual la Sociedad no esté
	obligada a responder; en esta situación, la compensación se tendra en cuenta para estimar el importe por
	el que, en su caso, figurara la correspondiente provisión.
	
	## Elementos patrimoniales de naturaleza medioambiental
	
	Se consideran activos de naturaleza medioambiental los bienes que son utilizados de forma duradera en la
	actividad de la Sociedad, cuya finalidad principal es la minimización del impacto medioambiental y la
	proteccion y mejora del medioambiente, incluyendo la reduccién o eliminación de la contaminacién futura.
	La actividad de la Sociedad, por su naturaleza no tiene un impacto medicambiental significativo.
	
	## Transacciones con vinculadas
	
	La Sociedad realiza todas sus operaciones con vinculadas a valores de mercado.
	
	EOF
    return 0
}
hledger_ca_mem_3_existencias() {
    case "$(getinfo -g COMPANY_CA_EXISTENCIAS=existencias)" in
        registro_mercantil)
            cat <<-EOF
		## Existencias
		
		Las existencias de la sociedad corresponden con provistones realizadas al Registro Mercantil.
		
		EOF
            ;;
    esac
}
## -------------------------------------------------------------------
hledger_ca_mem_4() { # Inmovilizado
    echo "(vacio)"
}
## -------------------------------------------------------------------
hledger_ca_mem_5() { # Activos financieros
    cat <<-EOF
	# Activos Financieros
	
	En función de la clasificación establecida por el PGC en sus
	normas de registro y valoración para los activos financieros, la
	Sociedad mantiene los siguientes saldos a corto plazo al cierre
	del ejercicio $(hledger_get year1) (en euros):
	EOF
    hledger_es \
        --begin="$(hledger_get year2)-01-01" \
        --end="$(hledger_get year1)-12-31"   \
        --yearly \
        balance \
        -H \
        'A:Corriente:Tesoreria:'
    return 0
}
hledger_ca_mem_6() { # Pasivos financieros
    cat <<-EOF
	# Pasivos Financieros
	
	En función de la clasificación establecida por el PGC en sus
	normas de registro y valoración para los pasivos financieros, la
	Sociedad mantiene los siguientes saldos a corto plazo al cierre
	del ejercicio $(hledger_get year1) (en euros):
	EOF
    hledger_es \
        --begin="$(hledger_get year2)-01-01" \
        --end="$(hledger_get year1)-12-31"   \
        --yearly \
        balance \
        -H \
        'P:Corriente:'
    return 0
}
## -------------------------------------------------------------------
hledger_ca_mem_7() { 
    cat <<-EOF
	# Fondos propios
	
	Al cierre del ejercicio $(hledger_get year1), el capital social de la Sociedad asciende a $(getinfo -g COMPANY_SOCIAL_CAPITAL_EUROS=s) euros, representado por $(getinfo -g COMPANY_NUMBER_OF_SHARES=s)
	participaciones de un euro de valor nominal cada una, todas ellas de la misma clase, totalmente suscritas y
	desembolsadas.
	
	$(getinfo -G COMPANY_OWNERS=s)
	EOF
}
## -------------------------------------------------------------------
hledger_ca_mem_8() { # Situación fiscal
    cat <<-EOF
	# Situación Fiscal
	
	En el ejercicio $(hledger_get year1) no ha habido actividad fiscal alguna.
	EOF
}
hledger_ca_mem_9() { # Operaciones con partes vinculadas
    echo "(vacio)"
}
hledger_ca_mem_10() { # Otra información
    echo "(vacio)"
}
## -------------------------------------------------------------------
getinfo_c_existencias() {
    case "$2" in
        registro_mercantil) true;;
        *)
            echo >&2 "error: COMPANY_CA_EXISTENCIAS: Shall be one of:"
            echo >&2 "       - registro_mercantil"
            return 1
            ;;
    esac
}
## -------------------------------------------------------------------
if test @"${SCRNAME:-$(basename "$0")}" = @"hledger-ca-mem"; then
    case "${1}" in
        ''|-h|--help) sed -n 's/^ *#h: \{0,1\}//p' "$0";;
        *)            hledger_ca_mem "$@"; exit 0;;
    esac
fi
